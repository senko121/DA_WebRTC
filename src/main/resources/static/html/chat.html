<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebSocket Chat</title>
    <link rel="stylesheet" href="../css/chat.css" />
  </head>

  <body>
    <h2>üí¨ WebSocket Chat</h2>

    <div class="join-room">
      <input type="text" id="username" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n" />
      <input type="text" id="roomName" placeholder="Nh·∫≠p t√™n ph√≤ng" />
      <button onclick="joinRoom()">Tham gia ph√≤ng</button>
    </div>

    <div class="chat-box">
      <div id="messages"></div>

      <div class="input-area">
        <input
          type="text"
          id="msgInput"
          placeholder="Nh·∫≠p tin nh·∫Øn..."
          onkeydown="if(event.key==='Enter') sendMessage();"
        />
        <button onclick="sendMessage()">G·ª≠i</button>
      </div>
    </div>

    <script src="../js/app.js"></script>
    <script>
      let joinedRoom = null;
      let currentUser = null;
      let currentToken = ""; // T·∫°m th·ªùi gi·∫£ l·∫≠p token

      function joinRoom() {
        const username = document.getElementById("username").value.trim();
        const roomName = document.getElementById("roomName").value.trim();

        if (!username || !roomName) {
          alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß t√™n v√† ph√≤ng!");
          return;
        }

        currentUser = username;
        joinedRoom = roomName;

        connectWebSocket();

        document.querySelector(".join-room").innerHTML = `
          <p>üë§ <b>${username}</b> ƒë√£ v√†o ph√≤ng <b>${roomName}</b></p>
        `;
      }
    </script>
  </body>
</html>
